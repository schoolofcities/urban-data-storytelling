<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nate Wessel">

<title>OpenStreetMap ‚Äì Urban Data Storytelling üìäüìàüèôÔ∏è</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/favicon.svg" rel="icon" type="image/svg+xml">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-6fbcbd56e20030bb8c94bdea314e40aa.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-XB09CWTEWB"></script>
<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-XB09CWTEWB');
</script>

<meta name="description" content="Notebooks on urban data analysis and visualization">
<meta name="author" content="School of Cities">

<meta property="og:title" content="OpenStreetMap ‚Äì Urban Data Storytelling üìäüìàüèôÔ∏è">
<meta name="og:description" content="Notebooks on urban data analysis and visualization">
<meta property="og:type" content="website">
<meta property="og:url" content="https://schoolofcities.github.io/urban-data-storytelling">
<meta property="og:image" content="https://raw.githubusercontent.com/schoolofcities/urban-data-storytelling/refs/heads/main/assets/web-card.png">
<meta property="og:locale" content="en_CA">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="https://schoolofcities.github.io/urban-data-storytelling">
<meta name="twitter:creator" content="@UofTCities">
<meta name="twitter:title" content="OpenStreetMap ‚Äì Urban Data Storytelling üìäüìàüèôÔ∏è">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://raw.githubusercontent.com/schoolofcities/urban-data-storytelling/refs/heads/main/assets/web-card.png">


<link rel="stylesheet" href="../../assets/styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">
      &lt;img src='https://raw.githubusercontent.com/schoolofcities/gta-immigration/refs/heads/main/src/assets/top-logo-full.svg' style='height:auto;width:250px;margin-left: -20px;'&gt;&lt;/img&gt;&lt;br&gt;Urban Data Storytelling üìäüìàüèôÔ∏è
      </li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../"><img src="https://raw.githubusercontent.com/schoolofcities/gta-immigration/refs/heads/main/src/assets/top-logo-full.svg" style="height:auto;width:250px;margin-left: -20px;"><br>Urban Data Storytelling üìäüìàüèôÔ∏è</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Urban Data Storytelling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../urban-data-storytelling/urban-data-storytelling-importance/urban-data-storytelling-importance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The importance of urban data storytelling</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Urban Data Analytics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../urban-data-analytics/what-and-where-of-data/what-and-where-of-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to urban data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../urban-data-analytics/measuring-the-city/measuring-the-city.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Measuring the city: metrics and indicators</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../urban-data-analytics/data-ethics-and-literacy/data-ethics-and-literacy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data ethics and literacy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../urban-data-analytics/intro-to-python-and-jupyter/intro-to-python-and-jupyter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programming with Python and computational notebooks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../urban-data-analytics/data-analytics-and-processing/data-analytics-and-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Processing and analyzing data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../urban-data-analytics/statistical-foundations/statistical-foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical foundations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../urban-data-analytics/spatial-data-and-gis/spatial-data-and-gis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spatial data and GIS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../urban-data-analytics/spatial-data-in-python/spatial-data-in-python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spatial data in Python</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../urban-data-analytics/spatial-data-processing/spatial-data-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spatial data processing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../urban-data-analytics/canadian-census-data/canadian-census-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview of Canadian census data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../urban-data-analytics/us-census-data/us-census-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview of U.S. census data</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Urban Data Visualization</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../urban-data-visualization/data-visualization/data-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../urban-data-visualization/exploratory-data-visualization/exploratory-data-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory data visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../urban-data-visualization/maps-and-spatial-data-visualization/maps-and-spatial-data-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Maps and visualizing spatial data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../urban-data-visualization/choropleth-maps/choropleth-maps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Choropleth maps</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../urban-data-visualization/bivariate-choropleth-maps/bivariate-choropleth-maps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bivariate choropleth maps</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../urban-data-visualization/proportional-symbol-maps/proportional-symbol-maps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Proportional symbol maps</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../urban-data-visualization/flow-maps/flow-maps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Flow maps</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../urban-data-visualization/categorical-dot-maps/categorical-random-dot-maps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Categorical dot maps</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#what-is-openstreetmap" id="toc-what-is-openstreetmap" class="nav-link active" data-scroll-target="#what-is-openstreetmap">What is OpenStreetMap?</a></li>
  <li><a href="#whats-on-the-map" id="toc-whats-on-the-map" class="nav-link" data-scroll-target="#whats-on-the-map">What‚Äôs on the map?</a></li>
  <li><a href="#how-is-the-data-structured" id="toc-how-is-the-data-structured" class="nav-link" data-scroll-target="#how-is-the-data-structured">How is the data structured?</a>
  <ul class="collapse">
  <li><a href="#spatial-data" id="toc-spatial-data" class="nav-link" data-scroll-target="#spatial-data">Spatial data</a></li>
  <li><a href="#attributes-tags" id="toc-attributes-tags" class="nav-link" data-scroll-target="#attributes-tags">Attributes (tags)</a></li>
  <li><a href="#spatial-data-tags" id="toc-spatial-data-tags" class="nav-link" data-scroll-target="#spatial-data-tags">Spatial data + tags</a></li>
  </ul></li>
  <li><a href="#strengths-and-weaknesses-of-osm-as-a-dataset" id="toc-strengths-and-weaknesses-of-osm-as-a-dataset" class="nav-link" data-scroll-target="#strengths-and-weaknesses-of-osm-as-a-dataset">Strengths and weaknesses of OSM as a dataset</a>
  <ul class="collapse">
  <li><a href="#strengths" id="toc-strengths" class="nav-link" data-scroll-target="#strengths">Strengths</a></li>
  <li><a href="#weaknesses" id="toc-weaknesses" class="nav-link" data-scroll-target="#weaknesses">Weaknesses</a></li>
  </ul></li>
  <li><a href="#access-the-data-and-contribute-edits" id="toc-access-the-data-and-contribute-edits" class="nav-link" data-scroll-target="#access-the-data-and-contribute-edits">Access the data and contribute edits</a>
  <ul class="collapse">
  <li><a href="#downloading-data" id="toc-downloading-data" class="nav-link" data-scroll-target="#downloading-data">Downloading data</a></li>
  <li><a href="#contributing-edits" id="toc-contributing-edits" class="nav-link" data-scroll-target="#contributing-edits">Contributing edits</a></li>
  </ul></li>
  <li><a href="#concluding-thoughts" id="toc-concluding-thoughts" class="nav-link" data-scroll-target="#concluding-thoughts">Concluding thoughts</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"><h1 class="title display-7">OpenStreetMap</h1></header>

<header id="title-block-header">

<p class="author">Nate Wessel</p>

</header>


<p>This notebook is meant to introduce the reader to OpenStreetMap - what it is, how to use it, and when and why you might want to. This is written for an audience that has some familiarity with spatial data and its applications.</p>
<section id="what-is-openstreetmap" class="level2">
<h2 data-anchor-id="what-is-openstreetmap">What is OpenStreetMap?</h2>
<p>OpenStreetMap (OSM) is a world-wide, collaborative mapping project spanning a huge range of subjects. You might think of it as Wikipedia, if Wikipedia were a map instead of a written body of text. Anyone with a computer can contribute edits and can also download and use that data, along with the contributions of millions of others, for a wide range of uses. <a href="https://www.openstreetmap.org/copyright" target="_blank">Specifically</a>:</p>
<blockquote class="blockquote">
<p>You are free to copy, distribute, transmit and adapt our data, as long as you credit OpenStreetMap and its contributors. If you alter or build upon our data, you may distribute the result only under the same licence. The full <a href="https://opendatacommons.org/licenses/odbl/1.0/" target="_blank">legal code</a> explains your rights and responsibilities.</p>
</blockquote>
<p>This openness has led to a huge number of applications based on OSM, ranging from large companies offering maps or navigation services, to many thousands of smaller projects started by software developers, activists, academics, and hobbyists.</p>
<p>At the technical level, OSM is just a big spatial database run by the OpenStreetMap Foundation. It sits on a server somewhere and people access it over the web to make edits and download data. But OSM is also a community and a practice. Decisions about how it runs and what gets mapped are largely decentralized, and often local.</p>
</section>
<section id="whats-on-the-map" class="level2">
<h2 data-anchor-id="whats-on-the-map">What‚Äôs on the map?</h2>
<p>The types of things included on the map range widely, from the <a href="https://wiki.openstreetmap.org/wiki/Tag:natural%3Dglacier" target="_blank">glaciers</a> of Greenland to the <a href="https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dcafe" target="_blank">cafe</a> around the corner from you. <a href="https://wiki.openstreetmap.org/wiki/Tag:route%3Dtrain" target="_blank">Train routes</a> are on there, as are <a href="https://wiki.openstreetmap.org/wiki/Buildings" target="_blank">buildings</a>, hundreds of millions of them, all the way down to your <a href="https://wiki.openstreetmap.org/wiki/Tag:building%3Dapartments" target="_blank">apartment</a> or your mom‚Äôs garden <a href="https://wiki.openstreetmap.org/wiki/Tag:building%3Dshed" target="_blank">shed</a>. However OpenStreetMap does not cover all subject matter. The basic rule is that data should be, in some sense, <a href="https://wiki.openstreetmap.org/wiki/Verifiability" target="_blank">verifiable</a> by a person on the ground in a real tangible way. This allows us to map sidewalks if they‚Äôre there, but not the fact that a census tract contains people 37.8% of whom spoke French at home in the year 2021. It‚Äôs <a href="https://wiki.openstreetmap.org/wiki/Scope" target="_blank">not a map of everything</a>.</p>
<p>To give another example, you could map that a <a href="https://wiki.openstreetmap.org/wiki/Tag:amenity%3Drestaurant" target="_blank">restaurant</a> exists and serves <a href="https://wiki.openstreetmap.org/wiki/Key:cuisine" target="_blank">Tibetan food</a> (that‚Äôs probably spelled out on their menu, along with their hours and address), but it would be impossible to indicate that the neighbourhood contains many people from Tibet, because‚Ä¶ I guess you‚Äôd have to ask them all? What would be meant by ‚Äúmany‚Äù or even ‚Äúneighbourhood‚Äù? People will come to very different conclusions on that one. That‚Äôs not independently <em>verifiable</em>.</p>
<p>Whether there is or is not a <a href="https://wiki.openstreetmap.org/wiki/Tag:highway%3Dbus_stop" target="_blank">bus stop</a> in a given spot is much more verifiable. In a given context at least, we can probably all agree what counts as a bus stop. This verifiability requirement leads OSM to a sort of discreteness that not all mapping efforts share. Something does or does not exist, is this type of thing or that type of thing. OSM doesn‚Äôt allow things to kind of exist or exist to a degree. It doesn‚Äôt allow us to have competing versions of reality.</p>
<p>One important exception to the verifiability rule is <a href="https://wiki.openstreetmap.org/wiki/Tag:boundary%3Dpolitical" target="_blank">political</a> or <a href="https://wiki.openstreetmap.org/wiki/Tag:boundary%3Dadministrative" target="_blank">administrative boundaries</a>, which often have no tangible existence in the real world. These are included for completeness, and because they rarely change, but should generally not be considered as authoritative. OSM also doesn‚Äôt include private or identifiable information. You can map a house, but not say who lives there, and you also won‚Äôt find any property lines in OSM, unless they just so happen to be marked by some physical boundary like a <a href="https://wiki.openstreetmap.org/wiki/Tag:barrier%3Dfence" target="_blank">fence</a>.</p>
</section>
<section id="how-is-the-data-structured" class="level2">
<h2 data-anchor-id="how-is-the-data-structured">How is the data structured?</h2>
<p>There are two aspects to pretty much any spatial dataset: the geometries and the attributes.</p>
<section id="spatial-data" class="level3">
<h3 data-anchor-id="spatial-data">Spatial data</h3>
<p>OSM uses a <em>vector</em> data model, not a <em>raster</em> model. Rasters are pixels covering an area with a gradation of values. Vectors are discrete points and lines in space. In OSM, the fundamental types of spatial data are <em>nodes</em>, <em>ways</em>, and <em>relations</em>.</p>
<ul>
<li><em>Nodes</em>: Nodes or points have a single coordinate location. They may exist on their own or be members of the other types. You might map a smallish object like a <a href="https://wiki.openstreetmap.org/wiki/Tag:amenity%3Dpost_box" target="_blank">post box</a> as a node.</li>
<li><em>Ways</em>: Ways consist of an ordered series of two or more nodes. A way that starts and ends at different nodes is a line while one that starts and ends at the same node is often (but not always) considered a closed polygon. You would probably map a <a href="https://wiki.openstreetmap.org/wiki/Key:highway" target="_blank">street</a> as an open way (line), and a <a href="https://wiki.openstreetmap.org/wiki/Tag:landuse%3Dcemetery" target="_blank">cemetery</a> as a closed way (polygon).</li>
<li><em>Relations</em>: Relations are grouped collections of any of these data types, including, reflexively, relations. These are the most complex type. A tram route for example would be a relation. It has a route (the tracks it follows) and also some stops or platforms which could be represented as points or polygons along the route. Relations can also used be used to break up very large features like the <a href="https://wiki.openstreetmap.org/wiki/Great_Lakes" target="_blank">Great Lakes</a>, which might otherwise cause your computer to overheat. Or they can be used to describe multipolygon or multiline geometry types.</li>
</ul>
</section>
<section id="attributes-tags" class="level3">
<h3 data-anchor-id="attributes-tags">Attributes (tags)</h3>
<p>The way OSM handles attributes, ‚Äú<a href="https://wiki.openstreetmap.org/wiki/Tags" target="_blank">tags</a>‚Äù in OSM parlance, is different from many other datasets you may be familiar with, especially those from government sources. Tags are associated with nodes, ways, and/or relations, though many nodes and ways may also have no tags at all if they belong to one of the other types (ways or relations) which has its own tags to describe the whole feature.</p>
<p>Tags take the form of <code>key=value</code> pairs, such as <code>building=residential</code> or <code>amenity=restaurant</code>. Usually, like these examples, their meaning is intuitively obvious, at least to an anglophone. In other cases, a more complex pattern has become the norm. For example, an address could be indicated with a set of tags like:</p>
<ul>
<li><code>addr:housenumber=123</code></li>
<li><code>addr:unit=B</code></li>
<li><code>addr:street=Example Street</code></li>
<li><code>addr:postcode=A1B2C3</code></li>
<li><code>addr:city=London</code></li>
</ul>
<p>This approach breaks the address down into its parts to make the result more machine readable.</p>
<p>Tags, or at least their <em>keys</em> are always in English, and specifically British English since that‚Äôs where OSM originated. For names however (the tag for this is <a href="https://wiki.openstreetmap.org/wiki/Key:name" target="_blank"><code>name=*</code></a>), the practice is to always use the local language, for example <code>name=Ëá∫ÁÅ£</code>, while the English name can be given like <code>name:en=Taiwan</code>.</p>
<p>At this point, you may be noticing that I‚Äôm describing tagging with words like ‚Äúcould‚Äù, ‚Äúmay‚Äù, ‚Äúthe practice is‚Äù‚Ä¶ This is because there‚Äôs no single authority on what tags are valid or how they need to be constructed except for the technical constraint that both the keys and values are text strings. Instead, the OSM community has established and documented a wide range of norms for tagging common, and not so common, features. The best way to find these is by searching the <a href="https://wiki.openstreetmap.org/" target="_blank">OSM wiki</a>, or perhaps by looking at what‚Äôs on the map in an area you‚Äôre familiar with. Tags that stray too far outside the norms are allowed but in practice are of little value. Applications that ingest OSM data may not support them and other mappers likely won‚Äôt know what to do with them either. Because of this, it can be important to know that a restaurant is <code>amenity=restaurant</code>, while a laundromat is <code>shop=laundry</code>. Why is it a <a href="https://wiki.openstreetmap.org/wiki/Key:shop" target="_blank">shop</a> and not also an <a href="https://wiki.openstreetmap.org/wiki/Key:amenity" target="_blank">amenity</a>? Well, for the same reason that you have a tailbone: because it started out that way and now it‚Äôs pretty baked in and it‚Äôs not causing any harm. There are a lot of little idiosyncrasies like that but they‚Äôre not too hard to remember after a while.</p>
<p>Another important difference from many spatial datasets is that there‚Äôs no real concept of completeness for tagging. What tags would exhaustively describe a restaurant for example? OSM is always a work in progress. Often the first person to add something to the map does something very simple: saying, ‚Äúthere‚Äôs a restaurant here‚Äù (<code>amenity=restaurant</code>) and then a month later someone comes by and adds the tag <code>cuisine=tibetan</code>, telling us that it serves Tibetan food. Later on, someone may add the name and a web address for the restaurant, a phone number, a list of payment methods accepted, whether they serve vegetarian dishes, how accessible the place is, the hours‚Ä¶ any combination of any of these tags may be found together. Just when you think you‚Äôve tagged every conceivable attribute, someone will come along and point out that the building has a grey, slate, Mansard style roof (<a href="https://wiki.openstreetmap.org/wiki/Key:roof:colour" target="_blank"><code>roof:colour=gray</code></a>, <a href="https://wiki.openstreetmap.org/wiki/Key:roof:material" target="_blank"><code>roof:material=slate</code></a>, <a href="https://wiki.openstreetmap.org/wiki/Tag:roof:shape%3Dmansard" target="_blank"><code>roof:shape=mansard</code></a>). It‚Äôs truly never done.</p>
</section>
<section id="spatial-data-tags" class="level3">
<h3 data-anchor-id="spatial-data-tags">Spatial data + tags</h3>
<p>Tags can be applied to nodes, ways, or relations, and there‚Äôs not always a prescribed spatial type needed to define a given feature. To take up the restaurant example again, in many dense areas, restaurants are mostly mapped as nodes, especially if they share a building with other uses. But if a restaurant has its own building, then the <code>amenity=restaurant</code> tag might go on the way (polygon) representing the building. If that building happened to have an interior courtyard, it would need to be mapped as a relation (because the polygon‚Äôs inner ring would make it a multi-geometry) and the restaurant tags would go on the relation.</p>
<p>As I indicated before, tagging is also somewhat optional. Most nodes in the database have no tags at all and simply serve to help define the shapes and positions of the tagged lines or polygons that reference them.</p>
<p>As you can see, OSM‚Äôs data structure is enormously flexible. This is a huge strength, given the enormous variety of real things out there in the world that we want to describe, but it can in equal measure be a liability for those who want to use OSM to answer ‚Äúsimple‚Äù questions like ‚ÄúHow many Tibetan restaurants are there in Toronto?‚Äù</p>
</section>
</section>
<section id="strengths-and-weaknesses-of-osm-as-a-dataset" class="level2">
<h2 data-anchor-id="strengths-and-weaknesses-of-osm-as-a-dataset">Strengths and weaknesses of OSM as a dataset</h2>
<p>OSM seems like the kind of thing you might either love or hate, but are unlikely to have ambivalent feelings about, at least if you‚Äôre a geospatial nerd like me. Its great for some applications and for others might just drive you insane.</p>
<section id="strengths" class="level3">
<h3 data-anchor-id="strengths">Strengths</h3>
<section id="flexibility-in-describing-the-world" class="level4">
<h4 data-anchor-id="flexibility-in-describing-the-world">Flexibility in describing the world</h4>
<p>As described in the previous section, OSM has great flexibility for describing things in the real world. The structure of tagging means we can add information as it becomes available, add detail to entities that are already in the database, and also describe things at various levels of detail, both spatially and in terms of attributes.</p>
</section>
<section id="osm-spans-boundaries" class="level4">
<h4 data-anchor-id="osm-spans-boundaries">OSM spans boundaries</h4>
<p>For much of my life, most of the world‚Äôs geospatial data was collected and administered by government agencies. These agencies did great work, right up to the edge of their jurisdiction and then beyond that was a vast, blank <em>terra incognita</em>. OpenStreetMap may include boundaries, but they sit inside of a global dataset and aren‚Äôt fundamental to how the map gets made. This means you can use OSM to analyse X or Y in North America, or within 500km of some point, without worrying about administrative differences in data collection.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/cross-border-route.png" class="img-fluid figure-img"></p>
<figcaption>A cycling route crossing international borders</figcaption>
</figure>
</div>
</section>
<section id="implicit-topology" class="level4">
<h4 data-anchor-id="implicit-topology">Implicit topology</h4>
<p>The topological (and cross-border) nature of OSM data makes it particularly well suited to transportation applications like finding walking or cycling directions from A to B. Indeed, this is the aspect of OSM to date that‚Äôs been the most widely commercialized, but it‚Äôs also available to you for free thanks to a wide range of open-source routing applications.</p>
</section>
<section id="version-control" class="level4">
<h4 data-anchor-id="version-control">Version control</h4>
<p>OSM is intended to represent the current state of the world, but it also maintains a history of past changes. While much of the history of OSM to-date has been a story of adding more and more detailed data, there‚Äôs also a vast store of real history slowly accumulating in the database. There‚Äôs the potential to rewind the clock and see that that Tibetan restaurant used to be a dispensary, and before that a church.</p>
</section>
<section id="it-accepts-your-edits" class="level4">
<h4 data-anchor-id="it-accepts-your-edits">It accepts your edits</h4>
<p>One of the biggest benefits of working with OSM data for a project may be a the simple fact that you can make edits. Inevitably, the data you need for your analysis will be incomplete. But you can use what‚Äôs in OSM already as a starting point and add the bits that are missing, allowing you to complete your analysis (without having to collect <em>all</em> the data) while at the same time leaving the map better than you found it. I‚Äôve done this myself many times. When working with typical spatial datasets, where you download everything from some organization, it can be very hard to make edits <em>and then also</em> synchronize those edits with any updates from the authoritative source.</p>
</section>
</section>
<section id="weaknesses" class="level3">
<h3 data-anchor-id="weaknesses">Weaknesses</h3>
<section id="inconsistency" class="level4">
<h4 data-anchor-id="inconsistency">Inconsistency</h4>
<p>OSM data can be wildly inconsistent in quality, detail, and scale. In many parts of central Europe, you‚Äôd be hard pressed to add any more to the map, where even individual street trees can appear with their <a href="https://wiki.openstreetmap.org/wiki/Key:genus" target="_blank">genus</a>, <a href="https://wiki.openstreetmap.org/wiki/Key:species" target="_blank">species</a>, and <a href="https://wiki.openstreetmap.org/wiki/Key:circumference" target="_blank">trunk circumference</a>. On the flip side, much of rural Africa and South America can look like it was hastily sketched on a napkin with even major features like roadways or rivers totally absent or misaligned by dozens of meters. Even within a city like Toronto the difference in quality and completeness between downtown and the suburbs is pretty noticeable if you‚Äôre paying attention.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/northern-ontario.png" class="img-fluid figure-img"></p>
<figcaption>Data in northern Ontario missing large, defining features of the landscape such as lakes</figcaption>
</figure>
</div>
</section>
<section id="strong-selection-biases-in-the-data-coverage" class="level4">
<h4 data-anchor-id="strong-selection-biases-in-the-data-coverage">Strong selection biases in the data coverage</h4>
<p>Even the inconsistency of OSM data is inconsistent. That is to say, the inconsistency is very much not random and subject to the interests and biases of the contributors. One example that stands out to me is the recent rise of paid map editors (yes, by the way, those exist!) working for big international navigation and logistics companies. These companies use OSM as their primary data source and are very interested in doing quality control on features that could lead to errors for in-vehicle navigation systems. This can mean that tagging errors in, say, major North American roadways are very quickly identified and fixed, while infrastructure for pedestrians just does not get the same scrutiny. A comparative analysis of those features would very much need to consider that one of those features has a lot of money behind it.</p>
</section>
<section id="osm-is-always-changing" class="level4">
<h4 data-anchor-id="osm-is-always-changing">OSM is always changing</h4>
<p>Even setting aside the issues around consistency and bias, the nature of OSM as a community driven project means that it‚Äôs always growing and evolving. This can be frustrating for data consumers. Let me give an example. I wanted to make a map of cycling infrastructure - bike lanes and the like - and had written code to look for three of the common tags for that:</p>
<ul>
<li><code>cycleway=lane</code></li>
<li><code>cycleway:left=lane</code></li>
<li><code>cycleway:right=lane</code></li>
</ul>
<p>These indicate respectively that a bike lane is on both sides of a street or just on the left or right side, depending which way the line is drawn. All was going well, until(!) at some point it started to become common to see the first tag supplanted by <code>cycleway:both=lane</code>, a tag that I didn‚Äôt even know to look for until I was deep into trying to figure out why some major lanes were missing from my map. The software I was using still doesn‚Äôt actually support this tagging out of the box, and it‚Äôs far too common in practice now for me to try to edit things back to the older tagging style. To keep my project up to date I must find ways to adapt my code.</p>
</section>
<section id="it-accepts-your-edits-1" class="level4">
<h4 data-anchor-id="it-accepts-your-edits-1">It accepts your edits</h4>
<p>Just as it‚Äôs a strength that the wise cartographer can add their wisdom to the map, so is it a detriment that any fool can add their foolishness too. Almost all edits to OSM are made in good faith but it‚Äôs the nature of a growing project that there will always be beginners making simple mistakes or failing to fully understand the norms of the community. If you‚Äôre reading this, it‚Äôs likely you‚Äôll make some mistakes too and perhaps you‚Äôll get a polite message from me or some other local mapper one day pointing out a better way of doing things. I‚Äôve found OSM to be a supportive community that happily welcomes and develops newcomers, but the truth is that the map at any given moment is likely full of small mistakes that haven‚Äôt been fixed yet.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/misuse-of-name-tag.png" class="img-fluid figure-img"></p>
<figcaption>A user has misused the <code>name=*</code> tag, filling it with a description and some kind of identifier. No one walking past this building would recognize that as its ‚Äúname‚Äù.</figcaption>
</figure>
</div>
<p>One example that comes to mind is the border between India and China. It‚Äôs a very large and complex boundary that neither country actually agrees on. OSM has a nuanced way of tagging <a href="https://wiki.openstreetmap.org/wiki/Disputed_territories" target="_blank">disputed political boundaries</a>, but I found that in practice the boundary relations for each country would often break down (i.e.&nbsp;fail to be a closed polygon) because novice editors didn‚Äôt understand this complexity. It was a pain to have to fix China and re-download the data every once in a while when I was regularly making maps of the region.</p>
</section>
</section>
</section>
<section id="access-the-data-and-contribute-edits" class="level2">
<h2 data-anchor-id="access-the-data-and-contribute-edits">Access the data and contribute edits</h2>
<p>OSM is just a big online database and you can connect to it to both read (download) data and edit (contribute) data. I‚Äôll start by describing the download process, but you‚Äôll want to make sure you give editing a try too. Even if you think you‚Äôll only ever download data, I‚Äôve found that, first of all, whatever you‚Äôre doing you‚Äôre going to find some data that just needs to be fixed and who better to do it than you? Second, editing puts you in the shoes of the people who make all the data in the first place. There‚Äôs just no better way to understand what you‚Äôre working with than to be part of the process of making it.</p>
<section id="downloading-data" class="level3">
<h3 data-anchor-id="downloading-data">Downloading data</h3>
<p>OpenStreetMap itself, that is, <a href="https://openstreetmap.org" target="_blank">openstreetmap.org</a> offers fairly limited ways of downloading data; you can download either all the data within a fairly small bounding box as an XML file, or you can download a compressed version (<code>.pbf</code>) of the entire planet. Unless you‚Äôre a professional database administrator with some time to kill (and disk space!), I wouldn‚Äôt recommend the later option. But let‚Äôs talk briefly about that XML file format. For a very simple example, it looks something like this:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode xml code-with-copy"><code class="sourceCode xml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">&lt;?xml</span><span class="ot"> version=</span><span class="st">"1.0"</span><span class="ot"> encoding=</span><span class="st">"UTF-8"</span><span class="fu">?&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">osm</span><span class="ot"> version=</span><span class="st">"0.6"</span><span class="ot"> generator=</span><span class="st">"openstreetmap-cgimap 2.0.1 (3529599 spike-06.openstreetmap.org)"</span><span class="ot"> copyright=</span><span class="st">"OpenStreetMap and contributors"</span><span class="ot"> attribution=</span><span class="st">"http://www.openstreetmap.org/copyright"</span><span class="ot"> license=</span><span class="st">"http://opendatacommons.org/licenses/odbl/1-0/"</span>&gt;</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">bounds</span><span class="ot"> minlat=</span><span class="st">"43.8697990"</span><span class="ot"> minlon=</span><span class="st">"-79.7034210"</span><span class="ot"> maxlat=</span><span class="st">"43.8708900"</span><span class="ot"> maxlon=</span><span class="st">"-79.7012510"</span>/&gt;</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">node</span><span class="ot"> id=</span><span class="st">"11278892239"</span><span class="ot"> visible=</span><span class="st">"true"</span><span class="ot"> version=</span><span class="st">"1"</span><span class="ot"> changeset=</span><span class="st">"142909966"</span><span class="ot"> timestamp=</span><span class="st">"2023-10-21T06:56:10Z"</span><span class="ot"> user=</span><span class="st">"nitemoon"</span><span class="ot"> uid=</span><span class="st">"15815701"</span><span class="ot"> lat=</span><span class="st">"43.8707980"</span><span class="ot"> lon=</span><span class="st">"-79.7028380"</span>/&gt;</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">node</span><span class="ot"> id=</span><span class="st">"11278892240"</span><span class="ot"> visible=</span><span class="st">"true"</span><span class="ot"> version=</span><span class="st">"1"</span><span class="ot"> changeset=</span><span class="st">"142909966"</span><span class="ot"> timestamp=</span><span class="st">"2023-10-21T06:56:10Z"</span><span class="ot"> user=</span><span class="st">"nitemoon"</span><span class="ot"> uid=</span><span class="st">"15815701"</span><span class="ot"> lat=</span><span class="st">"43.8707710"</span><span class="ot"> lon=</span><span class="st">"-79.7029400"</span>/&gt;</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">node</span><span class="ot"> id=</span><span class="st">"11278892241"</span><span class="ot"> visible=</span><span class="st">"true"</span><span class="ot"> version=</span><span class="st">"1"</span><span class="ot"> changeset=</span><span class="st">"142909966"</span><span class="ot"> timestamp=</span><span class="st">"2023-10-21T06:56:10Z"</span><span class="ot"> user=</span><span class="st">"nitemoon"</span><span class="ot"> uid=</span><span class="st">"15815701"</span><span class="ot"> lat=</span><span class="st">"43.8706280"</span><span class="ot"> lon=</span><span class="st">"-79.7028670"</span>/&gt;</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">node</span><span class="ot"> id=</span><span class="st">"11278892242"</span><span class="ot"> visible=</span><span class="st">"true"</span><span class="ot"> version=</span><span class="st">"1"</span><span class="ot"> changeset=</span><span class="st">"142909966"</span><span class="ot"> timestamp=</span><span class="st">"2023-10-21T06:56:10Z"</span><span class="ot"> user=</span><span class="st">"nitemoon"</span><span class="ot"> uid=</span><span class="st">"15815701"</span><span class="ot"> lat=</span><span class="st">"43.8706550"</span><span class="ot"> lon=</span><span class="st">"-79.7027640"</span>/&gt;</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">way</span><span class="ot"> id=</span><span class="st">"1217260361"</span><span class="ot"> visible=</span><span class="st">"true"</span><span class="ot"> version=</span><span class="st">"1"</span><span class="ot"> changeset=</span><span class="st">"142909966"</span><span class="ot"> timestamp=</span><span class="st">"2023-10-21T06:56:10Z"</span><span class="ot"> user=</span><span class="st">"nitemoon"</span><span class="ot"> uid=</span><span class="st">"15815701"</span>&gt;</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">nd</span><span class="ot"> ref=</span><span class="st">"11278892239"</span>/&gt;</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">nd</span><span class="ot"> ref=</span><span class="st">"11278892240"</span>/&gt;</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">nd</span><span class="ot"> ref=</span><span class="st">"11278892241"</span>/&gt;</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">nd</span><span class="ot"> ref=</span><span class="st">"11278892242"</span>/&gt;</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">nd</span><span class="ot"> ref=</span><span class="st">"11278892239"</span>/&gt;</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">tag</span><span class="ot"> k=</span><span class="st">"building"</span><span class="ot"> v=</span><span class="st">"yes"</span>/&gt;</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">tag</span><span class="ot"> k=</span><span class="st">"source"</span><span class="ot"> v=</span><span class="st">"microsoft/BuildingFootprints"</span>/&gt;</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">way</span>&gt;</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">osm</span>&gt;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Look closely and you can see that the file structure directly mirrors the structure of the OSM database described above. There are four nodes, each with a unique numeric ID and a set of coordinates. There‚Äôs also a single way which contains an ordered list of references to each of those four nodes, and some tags describing what the way is. Take a close look and you should be able to tell from the XML that we‚Äôre looking at a single rectangular building mapped as a closed polygon. Note that while there are four nodes, there are actually five references to them, with the first and last reference being to the same node ID. This is what tells us this is a closed polygon and not an open line. There‚Äôs also a lot of extra metadata in this file which tells us who created these elements and when. The nodes themselves in this case don‚Äôt have any tags.</p>
<p>But as I said, what OSM itself can give you is limited. OSM wants to conserve resources on their servers to ensure that contributors get the freshest data at the scale they need it to make edits.</p>
<p>Fortunately, OSM as a community has a variety of resources to fill the gaps for data consumers. These kind Internet strangers have downloaded that whole planet file and set up their copies to stay synchronized with the main database. They then offer additional ways of downloading larger chunks of data from their cloned databases, though often with some lag, ranging from minutes to days, from the main database.</p>
<section id="the-overpass-api" class="level4">
<h4 data-anchor-id="the-overpass-api">The Overpass API</h4>
<p>Perhaps the most versatile of these community sources is the <a href="https://overpass-turbo.eu/" target="_blank">Overpass API</a>. Overpass allows you to query the database in a great variety of ways using its own <a href="https://wiki.openstreetmap.org/wiki/Overpass_API/Overpass_QL" target="_blank">OSM-specific query language</a>. To be honest this can quickly get really complicated outside of some relatively simple use-cases, but it‚Äôs a really powerful tool if you‚Äôre willing to learn it. Here‚Äôs a really simple example to give you a flavour of it.</p>
<pre class="overpass"><code>[out:json][timeout:5][bbox:{{bbox}}];
(node[shop=wool];way[shop=wool];)-&gt;.elements;
.elements out geom;</code></pre>
<p>Pretty easy to read, right? Here‚Äôs the same example with some explanatory comments.</p>
<pre class="overpass"><code>[out:json][timeout:5][bbox:{{bbox}}];
// This is a comment. The lines above tell overpass to
// 1. output results as JSON
// 2. give up after 5 seconds if the query hasn't finished (lets the server plan better)
// 3. search only within the current map view

// gather results and store in .elements variable
(
    // the parentheses union nodes and ways together
    node[shop=wool]; // collects any ways with these tags
    way[shop=wool]; // collects any nodes...
) -&gt; .elements;
// output resulting geometries (and tags)
.elements out geom;</code></pre>
<p>Go to the <a href="https://overpass-turbo.eu/" target="_blank">Overpass API</a> and pop that query text in the sidebar. Zoom out until you can see your whole country and hit ‚Äúrun‚Äù. You should see a few scattered nodes show up on the map. Congrats! You just efficiently searched the many gigabytes of data within your map view for all the shops that sell yarn. Brits, by the way, call all sorts of yarn ‚Äúwool‚Äù, which can be quite confusing for people trying to knit with alpaca or acrylic fibres. This is a good example of the rule I mentioned earlier of tags always being in British English.</p>
<p>Now click the ‚Äúexport‚Äù tab to download the data in a variety of formats. If you wanted to quickly make a map with this in a standard desktop GIS, GeoJSON would be a good, straightforward choice. You could just drag this straight into QGIS and begin styling the layers.</p>
<p>Personally, I often use Overpass to download fresh (delayed by just a minute or two) city or metro level data. There‚Äôs actually a link for this directly on <a href="https://openstreetmap.org" target="_blank">openstreetmap.org</a>, which will download everything within the current (rectangular) map view as an XML file. Give it a try! Zoom to your city or neighborhood, go to the ‚Äúexport‚Äù option, and select ‚ÄúOverpass API‚Äù in the sidebar to download. If you go too big (e.g.&nbsp;country level), the API will timeout and throw an error.</p>
<p>Did you download a file? Good! Now you may be asking: &gt; What on Earth will I do with this 600MB XML file? I tried to open it with a text editor and my computer crashed!</p>
<p>Indeed. It‚Äôs a big file, and you‚Äôll probably want to use some kind of program to parse the file in some way before working with it. When making a map, I typically use a program called <a href="https://osm2pgsql.org/" target="_blank"><code>osm2pgsql</code></a> to import the XML data into a PostgreSQL database on my computer. Many other tools exist though. I‚Äôll just point to a few and let you explore their documentation on your own.</p>
<ul>
<li><a href="https://osmcode.org/osmium-tool/" target="_blank"><code>osmium</code></a>: extract and filter data, or convert between OSM formats like PBF, XML, and JSON</li>
<li><a href="https://wiki.openstreetmap.org/wiki/OGR" target="_blank"><code>ogr2ogr</code></a>: convert between OSM and many other spatal formats like GeoJSON or shapefile</li>
<li><a href="https://project-osrm.org/" target="_blank">Open Source Routing Machine (ORSM)</a>: parse the street network and set up an efficient and customizable routing engine</li>
</ul>
</section>
<section id="geofabrik-regional-downloads" class="level4">
<h4 data-anchor-id="geofabrik-regional-downloads">GeoFabrik Regional downloads</h4>
<p>Another handy resource offers downloads in a format that might be more familiar to the typical GISer. <a href="https://www.geofabrik.de/" target="_blank">GeoFabrik</a> is a German geospatial company which offers OSM <a href="https://download.geofabrik.de/" target="_blank">downloads</a> in both compressed XLM (<code>.osm.pbf</code>) and <em>shapefile</em> format, packaged into chunks split up by major regional and political boundaries. For example you could download data within <a href="https://download.geofabrik.de/north-america.html" target="_blank">North America</a>, <a href="https://download.geofabrik.de/north-america/canada.html" target="_blank">Canada</a> or <a href="https://download.geofabrik.de/north-america/canada/ontario.html" target="_blank">Ontario</a>.</p>
<p>Shapefiles are a very common format for spatial data which, like Ginko trees and horseshoe crabs, are a surprisingly ancient thing somehow still living among us. They‚Äôre tabular file format (that is, data in the form of a <em>table</em>), where each tagged entity (node, way, relation) is a row and each tag is a column. Because there are many, many tags, and most entities have only a few of them not all tags can be accommodated. Thus, the Geofabrik shapefiles can only include the most common tags, and are split into just a few thematic groups like buildings, landuse, natural features, place names, points of interest, etc. Shapefiles also must keep different geometry types separate, meaning there will be separate files for point, line, and polygon geometries.</p>
<p>These downloads can be a good entry point into OSM data if you‚Äôre already comfortable working with shapefiles but the file format limits what you can do with the data. If you want to make a quick map of common features without worrying too much about the nuances of the data structure, this is probably what you want.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/QGIS-Ontario-buildings.png" class="img-fluid figure-img"></p>
<figcaption>I was able to quickly make this map of the 2.9 million buildings mapped in Ontario so far</figcaption>
</figure>
</div>
</section>
</section>
<section id="contributing-edits" class="level3">
<h3 data-anchor-id="contributing-edits">Contributing edits</h3>
<p>To make edits, you‚Äôll need to create an OSM account. You can sign up or log in using the buttons on the top right of the page at <a href="https://www.openstreetmap.org" target="_blank">openstreetmap.org</a>.</p>
<p>Once you have an account, there are a few different ways of making edits. The most accessible and beginner friendly is the <em>iD editor</em>, which is built right into <a href="https://www.openstreetmap.org" target="_blank">openstreetmap.org</a>. It has a lot of useful features that help you find good descriptive tags for whatever you‚Äôre adding, but it can be pretty limited in its ability to make larger or more complex edits. It‚Äôs definitely the best place to start.</p>
<p>I‚Äôll also talk briefly about the <em>JOSM editor</em>, which is my usual go-to. It‚Äôs a much more powerful desktop GIS software that will let you do just about anything, but without a lot of the guardrails provided for newer uses by <em>iD</em>.</p>
<p>These aren‚Äôt the only editors though. Just as there are many ways to download data, contributed by the OSM community, there are many ways to edit it.</p>
<section id="the-id-editor" class="level4">
<h4 data-anchor-id="the-id-editor">The ID editor</h4>
<p>The iD editor is the beginner-friendly editor built right into the page at <a href="https://www.openstreetmap.org" target="_blank">openstreetmap.org</a>. Just click ‚Äúedit‚Äù in the top menu and you‚Äôll be able to edit the contents of your current map view.</p>
<p>For your first edit (you‚Äôre following along, right?) I recommend starting in a rural or suburban area that you‚Äôre at least somewhat familiar with. Unless the area you‚Äôre in is very densely mapped already, you should able to find some features which aren‚Äôt mapped yet. Once you‚Äôre in editing mode, you‚Äôll see OSM‚Äôs vector map data overlaid on top of some recent aerial imagery.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/iD-editor.png" class="img-fluid figure-img"></p>
<figcaption>The iD Editor, panning through rural Ontario</figcaption>
</figure>
</div>
<p>Pan the map until you find some clear features in the imagery that aren‚Äôt yet mapped. In the example above, I found some large buildings around what looks like a rural homestead (with a private basketball court??). To add the large building with the white roof as a polygon, I‚Äôll click on the ‚ÄúArea‚Äù button at the top, then click on each of the four corners of the building, double-clicking on the last one to close out the polygon.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/iD-polygon-drawn.png" class="img-fluid figure-img"></p>
<figcaption>The iD Editor, with a closed way (polygon) drawn but not tagged</figcaption>
</figure>
</div>
<p>I‚Äôve now drawn the way, but not yet added any tags. On the left-hand panel, you can see iD suggesting some things this feature might be. I can tell this is a building, but not what kind of building it is. Maybe it‚Äôs full of cows? Or it could be their private indoor hockey rink. Who knows. Scrolling through the options, I see ‚ÄúBuilding Features‚Äù, click that, then select just ‚ÄúBuilding‚Äù. I also could have used the search feature to get to the same result.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/iD-building.png" class="img-fluid figure-img"></p>
<figcaption>The iD Editor, with a closed way (polygon) drawn and tagged</figcaption>
</figure>
</div>
<p>I can now see the tag I‚Äôve added to this way (<code>building=yes</code>), along with some blanks for suggested tags that often accompany the <code>building=*</code> tag. For more information on any of these, you can click the ‚Äúi‚Äù button to get a detailed description of each tag. It‚Äôs OK to leave these tags blank.</p>
<p>For now, I‚Äôm happy with this edit and want to save it. I hit the ‚ÄúSave‚Äù button in the top right. Changes to the map are made in ‚Äúchangesets‚Äù and each one needs some description. I‚Äôll add a brief description for this simple edit, and also add a source for the information I‚Äôve added, selected from the drop-down selector. Adding a description and a source helps future editors understand something about the context of my edit.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/iD-save.png" class="img-fluid figure-img"></p>
<figcaption>The iD Editor, saving a changeset</figcaption>
</figure>
</div>
<p>Once you click the ‚ÄúUpload‚Äù button, your edit will be saved for all time in the OSM database. Be sure you haven‚Äôt done anything too silly, or added your banking information to the changeset comment. Here‚Äôs the edit I just made: <a href="https://www.openstreetmap.org/changeset/165765315" target="_blank">https://www.openstreetmap.org/changeset/165765315</a>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/fresh-edit.png" class="img-fluid figure-img"></p>
<figcaption>A recently uploaded changeset</figcaption>
</figure>
</div>
<p>You can see there‚Äôs a bit of extra information added by the editor, such as the actual source of the aerial imagery I was looking at. Notice that right after my edit, the building I added doesn‚Äôt actually show up on the main page‚Äôs map yet. My edit has made it into the OSM database, but it takes a while for changes to be reflected across the OSM ecosystem, such as on the rendered map or in data downloaded from other sources like those discussed above. By the time you‚Äôre reading this, you‚Äôll see the building at the link above, assuming it hasn‚Äôt been converted into a go-kart track by then.</p>
<p>As for your edit, if you wanted to confirm that your changes were saved, you could edit the map again in the same spot and you should see your modified data there since the editors all pull data, hot and fresh, from the main OSM database.</p>
</section>
<section id="josm" class="level4">
<h4 data-anchor-id="josm">JOSM</h4>
<p>While iD is the most popular OSM editor, and the best for beginners, you should also be aware that editors like <a href="https://josm.openstreetmap.de/" target="_blank">JOSM</a> are out there too. JOSM is basically a fully-featured desktop GIS specific to OSM. It has numerous plugins and a range of powerful (and potentially dangerous) features, like allowing the editing of many features at once. It you want to do some specific thing, but iD doesn‚Äôt seem to have a feature to support that, JOSM probably has three different ways of doing it.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/JOSM.png" class="img-fluid figure-img"></p>
<figcaption>The JOSM editor</figcaption>
</figure>
</div>
<p>For confident and experienced editors JOSM is a great tool but it can also be overwhelming and it counts on the user to know what they‚Äôre doing to a pretty large degree. While most individual OSM editors use iD, most actual map edits are made in JOSM.</p>
<p>To give an example, one important way of using JOSM is for <a href="https://wiki.openstreetmap.org/wiki/Import" target="_blank">data imports</a>. Now first of all, one does not simply import data into OSM from other sources. Imports are a long, arduous journey of a process involving much discussion with the community, whose consensus and approval is required, and a very thorough review of data licensing and permissions. But once an import process is underway, JOSM could be used to bring in hundreds or even thousands of features at a time, while checking for conflicts with preexisting data.</p>
</section>
</section>
</section>
<section id="concluding-thoughts" class="level2">
<h2 data-anchor-id="concluding-thoughts">Concluding thoughts</h2>
<p>OSM is a whole world unto itself, I guess quite literally. Over the last decade or so its millions of users around the world, spanning many languages and cultures have developed a shared representation of the entire world. Like that world, it‚Äôs big and complex and messy and still very much a work in progress. But it‚Äôs also filled to the brim with useful, and indeed fascinating information. OSM can take a while to familiarize yourself with, and indeed you‚Äôll never know everything about it. It‚Äôs just too big and it‚Äôs always changing. But I hope I‚Äôve enticed you here to look a little more into it and consider OSM data as a potentially valuable resource in your various endeavors.</p>
<p>Welcome to the OSM community!</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>